# BunMail

import Image from 'next/image';
import { Callout } from 'nextra/components';
import { GenerateHex } from '/functions/hex.js';
import { Steps } from 'nextra/components';

## ![logo](/BunMailLogo.png)

Hey there, welcome to BunMail! This is a nifty little email server designed to securely
send emails via POST requests. Plus, it's built on Bun! Cool, right?

## Usecase

BunMail is designed to serve as an email api endpoint for your applications. It's perfect for sending emails from your static site, or for sending emails from your backend without having to worry about setting up an email server or hardcoding emails into your apps or websites. Just send a POST request with the standard JSON body to BunMail and it'll take care of the rest!

BunMail can be used to send mail with:

<Steps>
### HTML / React / Vue / Angular/ Svelte 
	You can send emails straight from your website using the fetch api with form actions or javascript

### Shell Scripts

    You can send emails from your shell scripts using curl

### Postman

    You can send emails from the postman app

### And More!

    You can send emails from any application that can send POST requests

</Steps>

### 1. HTML

```html filename="somePage.html"
<html>
	<body>
		<script>
			fetch("your-bun-address/email", {method: 'POST' headers:{
				'content-type': 'application/json'},
					body: JSON.stringify({
					key: 'your-api-key',
					to: 'some@address.com',
					from: `"Your Sender Name" your_email@email.com`,
					subject: 'Your Subject',
					html: '<h1>Send Your Email as HTML</h1>'
				})
			})
		</script>
	</body>
</html>
```

## What You'll Need

BunMail is pretty light, <Callout emoji="ðŸš€"> **Less than 500mb!!!** </Callout> and can be run on any machine that can run Docker or Bun.

<GenerateHex> **hex**: </GenerateHex>
you will need to generate your own API key. You can do this by running the following
command:

```bash
openssl rand -hex 32
```

### With Docker Compose (Recommended)

#### 1. **Create the Docker Compose File**

```yaml
version: '3'

services:
  server:
    image: biohackerellie/bunmail
    container_name: BunEmailServer
    restart: unless-stopped
    ports:
      - '6969:6969'
    environment:
      API_KEY: ${API_KEY}
      GMAIL_USER: ${GMAIL_USER}
      GMAIL_PASSWORD: ${GMAIL_PASSWORD}
      ALLOWED_DOMAINS: ${ALLOWED_DOMAINS}
      # --- For Oauth2 ---
      OAUTH: ${OAUTH}
      CLIENT_ID: ${CLIENT_ID}
      CLIENT_SECRET: ${CLIENT_SECRET}
      REFRESH_TOKEN: ${REFRESH_TOKEN} #Optional
      ACCESS_TOKEN: ${ACCESS_TOKEN} #Optional
```

#### 2. Edit Environment Variables

- Option A: Create a `.env` file based on the provided `env.example` and fill in your own values. Keep the .env file in the same directory as the docker-compose.yml file.
- Option B: You can also directly edit the docker-compose.yml file if you'd rather:

```yaml
environment:
  API_KEY: Your-API-Key-Here
  GMAIL_USER: Your-Email-Here
  GMAIL_PASSWORD: Your-Password-Here
  ALLOWED_DOMAINS: Domain1,Domain2,Domain3 # or '*' for all domains
	OUATH: 'true' or 'false' # Default is false
  ### others as needed. See docs for configuring email providers
```

#### 3. Run Docker Compose

```bash
sudo docker compose up -d
```

That's it! Your server will be up and running at `http://localhost:6969`.

### Docker Run Command

You can also use the following docker run command instead of using docker compose:

```bash
docker run -p 6969:6969 \
-e API_KEY=Your-API-Key-Here \
-e GMAIL_USER=Your-Email-Here \
-e GMAIL_PASSWORD=Your-Password-Here \
-e ALLOWED_DOMAINS=Domain1,Domain2,Domain3 # or '*' for all domains \
 # --- Outh2 env variables if needed ---
biohackerellie/bunmail
```

### Without Docker

Alternatively, you can run the server without Docker. Just follow these steps:

1. Clone the repo
   ```bash
   git clone https://github.com/biohackerellie/Bunmail.git
   ```
2. Install Bun and the dependencies
   ```bash
   cd Bunmail \
   # Install Bun
   curl -fsSL https://bun.sh/install | bash && \
   # Install dependencies
   bun install
   ```
3. Create a `.env` file based on the provided `env.example` and fill in your own values.

4. Run the server
   ```bash
   bun run ./index.ts
   ```

## ðŸ’Œ How to Send Emails

Send a POST request to `http://localhost:6969/email` with the following JSON body:

```json
{
	"key": "Your-API-Key-Here",
	"to": "recipient@example.com",
	"from": "sender@example.com",
	"subject": "Hello, World!",
	"html": "<h1>Hi there!</h1>"
}
```

If everything's set up correctly, you'll get a sweet message back saying "Email Sent Successfully" ðŸŽ‰.
