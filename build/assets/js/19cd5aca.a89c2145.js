"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[820],{3905:(e,r,t)=>{t.d(r,{Zo:()=>l,kt:()=>y});var n=t(7294);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function c(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=n.createContext({}),u=function(e){var r=n.useContext(s),t=r;return e&&(t="function"==typeof e?e(r):i(i({},r),e)),t},l=function(e){var r=u(e.components);return n.createElement(s.Provider,{value:r},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},m=n.forwardRef((function(e,r){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=u(t),m=o,y=p["".concat(s,".").concat(m)]||p[m]||d[m]||a;return t?n.createElement(y,i(i({ref:r},l),{},{components:t})):n.createElement(y,i({ref:r},l))}));function y(e,r){var t=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=m;var c={};for(var s in r)hasOwnProperty.call(r,s)&&(c[s]=r[s]);c.originalType=e,c[p]="string"==typeof e?e:o,i[1]=c;for(var u=2;u<a;u++)i[u]=t[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}m.displayName="MDXCreateElement"},3494:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>c,toc:()=>u});var n=t(7462),o=(t(7294),t(3905));const a={},i="Convert Azure Groups to Active Directory Security Group",c={unversionedId:"PowerShell/Az to Ad",id:"PowerShell/Az to Ad",title:"Convert Azure Groups to Active Directory Security Group",description:"Working at a k-12 school district, we have students in after school activites who needed badge access to the building based on their activity time. Their classes sync into Azure automatically, and our security software syncs from AD so we needed a way to convert the classes into security groups, and then remove students from the access groups once they were no longer in the class or activity. This is what I came up with, and since I'm new to scripting languages in general, I'm keeping a record of all of these things I come up with \ud83e\udd37\u200d\u2640\ufe0f",source:"@site/docs/PowerShell/Az to Ad.md",sourceDirName:"PowerShell",slug:"/PowerShell/Az to Ad",permalink:"/docs/PowerShell/Az to Ad",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Powershell",permalink:"/docs/category/powershell"},next:{title:"Service Principal Setup Instructions",permalink:"/docs/PowerShell/Creat A service principal"}},s={},u=[],l={toc:u};function p(e){let{components:r,...t}=e;return(0,o.kt)("wrapper",(0,n.Z)({},l,t,{components:r,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"convert-azure-groups-to-active-directory-security-group"},"Convert Azure Groups to Active Directory Security Group"),(0,o.kt)("p",null,"Working at a k-12 school district, we have students in after school activites who needed badge access to the building based on their activity time. Their classes sync into Azure automatically, and our security software syncs from AD so we needed a way to convert the classes into security groups, and then remove students from the access groups once they were no longer in the class or activity. This is what I came up with, and since I'm new to scripting languages in general, I'm keeping a record of all of these things I come up with \ud83e\udd37\u200d\u2640\ufe0f"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-powershell"},"---\n\ninstall-module azuread\nimport-module azuread\nConnect-Azuread\n\n\n#Convert the Azure groups here. Add additional values as needed\n\n$map = @{\n    'Azure-Object-ID-01' = 'Active-directory-Security-Group-1' \n    'Azure-Object-ID-02' = 'Active-directory-Security-Group-2' \n    'Azure-Object-ID-03' = 'Active-directory-Security-Group-3'  \n    'Azure-Object-ID-04' = 'Active-directory-Security-Group-4'  \n}\n\nforeach($pair in $map.GetEnumerator()) {\n    $azMembers = [mailaddress[]] (get-AzureADGroupMember -ObjectID $pair.Key).UserPrincipalName\n    foreach($adGroup in $pair.Value) {\n        Add-AdGroupMember -Identity $adGroup -Members $azMembers.User \n        $allusers = Get-AdGroupMember -Identity $adGroup\n                    ##remove users no longer in Azure Group\n                    $remove = Get-AdGroupMember -Identity $adGroup | Where-Object SamAccountName -NotIn $azMembers.User \n                    Remove-ADGroupMember -Identity $adGroup -Members $remove -Confirm:$false \n        } \n}\n")),(0,o.kt)("p",null,"And here is a smaller example for just converting one group at a time "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-powershell"},"---\n\n$azgr = 'Azure-Group-ID'\n$adgr = 'AD-Group'\n\n$azuremem = [mailaddress[]] (get-AzureADGroupMember -ObjectId $azgr).UserPrincipalName\n\nAdd-ADGroupMember -Identity $adgr -Members $azuremem.User\n")))}p.isMDXComponent=!0}}]);